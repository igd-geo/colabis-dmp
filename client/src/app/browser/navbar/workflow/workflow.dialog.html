<div id="workflow-modal"
    class="uk-modal">
  <div class="uk-modal-dialog">
    <a class="uk-modal-close uk-close"></a>

    <div class="uk-modal-header">
      <h2>Import Workflow</h2>
    </div>

    <form (ngSubmit)="onSubmit(uploadForm)"
        #uploadForm="ngForm"
        class="uk-form uk-form-horizontal">
      <div id="workflow-drop"
          class="uk-placeholder uk-text-center">
        <i class="uk-icon-cloud-upload uk-icon-medium uk-text-muted uk-margin-small-right"></i> Attach ProvXML by dropping
        it here or
        <a class="uk-form-file">
          select it
          <input name="files" id="workflow-select"
                type="file" accept=".xml"
                (change)="onFilesChanged($event.target.files)" ngControl="files">
        </a>.
      </div>

      <ul *ngIf="file"
          class="uk-comment-list">
        <li>
          <div class="uk-comment">
            <div class="uk-comment-header">
              <div class="uk-comment-title uk-float-right">
                <a class="uk-icon uk-icon-hover uk-icon-pencil"
                    (click)="name.focus()"></a>
                <a class="uk-icon uk-icon-hover uk-icon-trash"
                    (click)="removeFile()"></a>
              </div>
              <i class="uk-comment-avatar uk-icon-large uk-icon-file-o"></i>
              <div #name
                  class="uk-comment-title file-name"
                  contenteditable="true"
                  (input)="workflowName = $event.target.innerText"
                  [init]="workflowName"
                  (keypress)="$event.which == 13 ? name.blur() : true">
              </div>
              <div class="uk-comment-meta">
                {{ file.type }} | {{ file.size | fileSize }}
              </div>
            </div>
            <div *ngIf="provXML" class="uk-comment-body">
              <table class="small uk-table uk-table-condensed uk-table-striped uk-table-hover">
                <colgroup>
                  <col class="uk-width-2-6">
                </colgroup>
                <thead>
                  <tr>
                    <td>Entity</td>
                    <td>Generated by</td>
                    <td>Attributed to</td>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let entity of provXML.entities">
                    <td>{{ entity.name }}</td>
                    <td>{{ entity.generatedBy.length}} Activities</td>
                    <td>{{ entity.attributedTo.length}} Organizations</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </li>
      </ul>
    </form>

    <div class="uk-modal-footer uk-text-right">
      <button type="button"
          class="uk-button"
          (click)="close()">Cancel</button>
      <button type="button"
          class="uk-button uk-button-primary"
          (click)="upload()"
          [disabled]="!uploadForm.form.valid">
          Create Workflow
        </button>
    </div>
  </div>
</div>
